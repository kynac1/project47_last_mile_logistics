#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_travel_dist_per_customer = sum(travel_dist_per_customer),
total_dist_driver = sum(distance) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, total_travel_dist_per_customer,  type="b", pch=15, col="blue", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="blue", col.axis="blue")
mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_travel_dist_per_customer[3], col="blue", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_dist_driver,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_travel_dist_per_customer = sum(travel_dist_per_customer),
total_dist_driver = sum(distance) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, total_travel_dist_per_customer, c(0,max(total_travel_dist_per_customer)), type="b", pch=15, col="blue", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="blue", col.axis="blue")
mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_travel_dist_per_customer[3], col="blue", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_dist_driver,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_travel_dist_per_customer = sum(travel_dist_per_customer),
total_dist_driver = sum(distance) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, total_travel_dist_per_customer, yylim =  c(0,max(total_travel_dist_per_customer)), type="b", pch=15, col="blue", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="blue", col.axis="blue")
mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_travel_dist_per_customer[3], col="blue", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_dist_driver,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_travel_dist_per_customer = sum(travel_dist_per_customer),
total_collection_dist_driver = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, total_travel_dist_per_customer, yylim =  c(0,max(total_travel_dist_per_customer)), type="b", pch=15, col="blue", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="blue", col.axis="blue")
mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_travel_dist_per_customer[3], col="blue", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,   total_collection_dist_driver,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_travel_dist_per_customer = sum(travel_dist_per_customer),
total_collection_dist_driver = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, total_travel_dist_per_customer, yylim =  c(0,max(total_travel_dist_per_customer)), type="b", pch=15, col="blue", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="blue", col.axis="blue")
mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_travel_dist_per_customer[3], col="blue", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,   total_collection_dist_driver,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total  Driver Collection Travelling Distance (m)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_travel_dist_per_customer = sum(travel_dist_per_customer),
total_collection_dist_driver = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, total_travel_dist_per_customer, yylim =  c(0,max(total_travel_dist_per_customer)), type="b", pch=15, col="blue", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="blue", col.axis="blue")
mtext(side = 4, line = 3, col="blue", 'Total Travelling Distance per Customer (m)')
abline(h=summ$ total_travel_dist_per_customer[3], col="blue", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,   total_collection_dist_driver,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total  Driver Collection Travelling Distance (m)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
# par(new = T)
# with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
# abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (m)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="red3", col.axis="red3")
mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (m)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="red3", col.axis="red3")
mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer/1000,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (km)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="red3", col.axis="red3")
mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer/1000,  , ylim = c(0,4000), type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (km)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(2000,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="red3", col.axis="red3")
mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer/1000,  , ylim = c(0,4000), type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (km)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="red3", col.axis="red3")
mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer/1000,  , ylim = c(2000,4000), type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (km)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
## Distance
# different measures of packages number vs capacity
# summ_distances <- data1 %>%
#   group_by(num_of_collection_points) %>%
#   summarize(driver_distance = sum(distance),
#             customer_distance = sum(collection_dist)) %>%
#   gather(key = "variable", value = "value", -num_of_collection_points)
#
# summ_distances %>%
#   ggplot(aes(x = num_of_collection_points, y = value)) + geom_line(aes(color = variable)) + geom_point(aes(color = variable)) + ggtitle("Distance vs. Futile Count Threshold") #+ facet_grid( . ~ variable)  #+ scale_color_manual(values = c("darkred", "steelblue"))
summ <- data1 %>%
filter(num_of_collection_points!=0) %>%
group_by(num_of_collection_points) %>%
summarize(avg.number_of_packages = mean(number_of_packages),
avg.travel_dist_per_customer = mean(travel_dist_per_customer),
total_collection_dist_customer = sum(collection_dist) )
summ
par(mar = c(5,5,2,5))
with(summ, plot(num_of_collection_points, avg.number_of_packages, type="b", ylim = c(0,200), xlab= "Number of Collection Points", ylab= "avg. Number of Packages", main="Effect of Number of Collection Points"))
abline(h=summ$avg.number_of_packages[3], col="black", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points, avg.travel_dist_per_customer, ylim = c(0,4000), type="b", pch=15, col="red3", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="red3", col.axis="red3")
mtext(side = 4, line = 3, col="red3", 'avg. Travelling Distance per Customer (m)')
abline(h=summ$ avg.travel_dist_per_customer[3], col="red3", lty=2, lwd=1)
par(new = T)
with(summ, plot(num_of_collection_points,  total_collection_dist_customer/1000,  , ylim = c(000,4000), type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
axis(side = 4, col="green", col.axis="green")
mtext(side = 4, line = 3, col="green3", 'Total Travelling Distance by Customer (km)')
abline(h=summ$  total_collection_dist_driver[3], col="green", lty=2, lwd=1)
#
# par(new = T)
# with(data1, plot(num_of_collection_points, arrival_packages,  type="b", pch=15, col="green", axes=F, xlab=NA, ylab=NA, cex=1.2))
# axis(side = 4, col="red3", col.axis="red3")
# mtext(side = 4, line = 3, col="red3", 'Total Travelling Distance per Customer (m)')
# twoord.plot(lx = summ$num_of_collection_points, ly = summ$ave.number_of_packages, rx = summ$num_of_collection_points, ry = summ$customer_distance,lylim=range(summ$ave.number_of_packages)+c(-20,10),  lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points")
# # twoord.stackplot(lx = summ$num_of_collection_points, ldata = summ$ave.number_of_packages, rx = summ$num_of_collection_points, rdata = summ$customer_distance,ltype=c("l","p"), rtype=c("l","p","o"), lylab="number_of_packages",rylab="customer_distance", xaxt = 'n', yaxt = 'n', xlab="Number of Collection Points", lcol=c("red"))
